webpackJsonp([4],{126:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.edit_cate=e.new_cate=e.tagslist=e.catelist=e.uploadCallback=e.update=e.up=e.down=e.remove=e.create=e.query=void 0;var n=a(53),u=r(n),s=a(154),c=r(s),i=(e.query=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.get)("/api/article/lists",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.create=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/article/create",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.remove=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/article/del",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.down=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/article/down",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.up=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/article/up",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.update=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/article/edit",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.uploadCallback=function(){var t=(0,c["default"])(u["default"].mark(function e(t){var a;return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FormData,a.append("file",t),e.abrupt("return",p["default"].post(o.apiURL+"/api/article/upload",a).then(function(t){return{data:{link:o.imgURL+t.data.data.path}}}));case 3:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.catelist=function(){var t=(0,c["default"])(u["default"].mark(function e(){return u["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.get)("/api/category/list"));case 1:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}(),e.tagslist=function(){var t=(0,c["default"])(u["default"].mark(function e(){return u["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.get)("/api/tags/list"));case 1:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}(),e.new_cate=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/category/new",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),e.edit_cate=function(){var t=(0,c["default"])(u["default"].mark(function e(t){return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.post)("/api/category/edit",{data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),a(133)),p=r(i),o=a(127),l=a(34)},153:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(3),u=r(n),s=(a(114),a(113)),c=r(s),i=a(53),p=r(i),o=a(126);a(128);e["default"]={namespace:"articles",state:{list:[],currentItem:{},modalVisible:!1,modalType:"create",cateModalType:"new",isView:!1,cateList:[],tagsList:[],pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:function(t){return"\u5171 "+t+" \u6761"},current:1,total:null,pageSize:null}},subscriptions:{setup:function(t){var e=t.dispatch,a=t.history;return a.listen(function(t){"/articles/list"===t.pathname||"/articles"===t.pathname?(e({type:"query",payload:t.query}),e({type:"cateList"}),e({type:"tagsList"})):"/articles/category"===t.pathname?e({type:"cateList"}):"/articles/tag"===t.pathname&&e({type:"tagsList"})})}},effects:{query:p["default"].mark(function l(t,e){var a,r,n=t.payload,u=e.call,s=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u(o.query,n);case 2:if(a=t.sent,r=a.data,!r){t.next=7;break}return t.next=7,s({type:"updateState",payload:{list:r.data,pagination:{total:parseInt(r.pagination.total,10),current:parseInt(r.pagination.current,10)||1,pageSize:parseInt(n.pageSize,10)||10}}});case 7:case"end":return t.stop()}},l,this)}),reload:p["default"].mark(function d(t,e){var a,r=(t.action,e.put),n=e.select;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(function(t){return t.articles.pagination.current});case 2:return a=t.sent,t.next=5,r({type:"query",payload:{page:a}});case 5:case"end":return t.stop()}},d,this)}),create:p["default"].mark(function f(t,e){var a,r,n=t.payload,u=e.call,s=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s({type:"hideModal"});case 2:return t.next=4,u(o.create,n);case 4:if(a=t.sent,r=a.data,!r.success){t.next=10;break}return c["default"].success("save success",1),t.next=10,s({type:"reload"});case 10:case"end":return t.stop()}},f,this)}),update:p["default"].mark(function h(t,e){var a,r,n,s=t.payload,i=e.select,l=e.call,d=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d({type:"hideModal"});case 2:return t.next=4,i(function(t){var e=t.articles;return e.currentItem._id});case 4:return a=t.sent,r=(0,u["default"])({},s,{id:a}),t.next=8,l(o.update,r);case 8:if(n=t.sent,!n.data.success){t.next=13;break}return c["default"].success("update success",1),t.next=13,d({type:"reload"});case 13:case"end":return t.stop()}},h,this)}),remove:p["default"].mark(function y(t,e){var a,r=t.payload,n=e.call,u=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(o.remove,{id:r});case 2:if(a=t.sent,!a.data.success){t.next=6;break}return t.next=6,u({type:"reload"});case 6:case"end":return t.stop()}},y,this)}),down:p["default"].mark(function w(t,e){var a,r=t.payload,n=e.call,u=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(o.down,{id:r});case 2:if(a=t.sent,!a.data.success){t.next=6;break}return t.next=6,u({type:"reload"});case 6:case"end":return t.stop()}},w,this)}),up:p["default"].mark(function v(t,e){var a,r=t.payload,n=e.call,u=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(o.up,{id:r});case 2:if(a=t.sent,!a.data.success){t.next=6;break}return t.next=6,u({type:"reload"});case 6:case"end":return t.stop()}},v,this)}),tagsList:p["default"].mark(function x(t,e){var a,r=(t.payload,e.call),n=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(o.tagslist);case 2:return a=t.sent,t.next=5,n({type:"tags",payload:{tagsList:a.data.tagslist}});case 5:case"end":return t.stop()}},x,this)}),cateList:p["default"].mark(function m(t,e){var a,r=(t.payload,e.call),n=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(o.catelist);case 2:return a=t.sent,t.next=5,n({type:"cate",payload:{cateList:a.data.catelist}});case 5:case"end":return t.stop()}},m,this)}),new_cate:p["default"].mark(function g(t,e){var a,r,n=t.payload,u=e.call,s=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s({type:"hideModal"});case 2:return t.next=4,u(o.new_cate,n);case 4:if(a=t.sent,r=a.data,!r.success){t.next=12;break}return c["default"].success(r.message,1),t.next=10,s({type:"cateList"});case 10:t.next=13;break;case 12:c["default"].error(r.message);case 13:case"end":return t.stop()}},g,this)}),edit_cate:p["default"].mark(function k(t,e){var a,r,n,s=t.payload,i=e.select,l=e.call,d=e.put;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d({type:"hideModal"});case 2:return t.next=4,i(function(t){var e=t.articles;return e.currentItem._id});case 4:return a=t.sent,r=(0,u["default"])({},s,{id:a}),t.next=8,l(o.edit_cate,r);case 8:if(n=t.sent,!n.data.success){t.next=13;break}return c["default"].success(n.data.message,1),t.next=13,d({type:"cateList"});case 13:case"end":return t.stop()}},k,this)})},reducers:{updateState:function(t,e){var a=e.payload,r=a.list,n=a.pagination;return(0,u["default"])({},t,{list:r,pagination:(0,u["default"])({},t.pagination,n)})},showModal:function(t,e){return(0,u["default"])({},t,e.payload,{modalVisible:!0})},hideModal:function(t){return(0,u["default"])({},t,{modalVisible:!1})},cate:function(t,e){var a=e.payload.cateList;return(0,u["default"])({},t,{cateList:a})},tags:function(t,e){var a=e.payload.tagsList;return(0,u["default"])({},t,{tagsList:a})}}},t.exports=e["default"]},1241:function(t,e){"use strict"}});